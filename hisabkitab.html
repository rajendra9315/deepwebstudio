<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Personal Accounting System</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body { font-family: Arial, sans-serif; background:#f4f6f8; margin:0; padding:20px; }
    h1,h2 { color:#222; }
    .card { background:#fff; padding:16px; border-radius:8px; margin-bottom:20px; box-shadow:0 2px 6px rgba(0,0,0,0.08); }
    .scroll { max-height:320px; overflow-y:auto; }
    input, select, textarea, button { width:100%; padding:8px; margin:6px 0; }
    button { background:#2563eb; color:#fff; border:none; border-radius:6px; cursor:pointer; }
    table { width:100%; border-collapse:collapse; }
    th, td { border:1px solid #ddd; padding:8px; text-align:left; }
    th { background:#f0f0f0; }
    .tabs button{ width:auto; margin-right:6px }
  </style>
</head>
<body>

<h1>üìò Personal Accounting Web App</h1>
<p>All data is saved locally in your browser (no internet, no tracking).</p>

<!-- FILTER BUTTON -->
<div class="card">
  <button onclick="toggleFilter()">üìÖ Filter</button>
  <div id="filterBox" style="display:none;margin-top:10px">
    <input type="date" id="fromDate" />
    <input type="date" id="toDate" />
    <select id="month">
      <option value="">All Months</option>
      <option value="0">Jan</option><option value="1">Feb</option><option value="2">Mar</option>
      <option value="3">Apr</option><option value="4">May</option><option value="5">Jun</option>
      <option value="6">Jul</option><option value="7">Aug</option><option value="8">Sep</option>
      <option value="9">Oct</option><option value="10">Nov</option><option value="11">Dec</option>
    </select>
    <button onclick="applyFilter()">Apply</button>
    <button onclick="clearFilter()" style="background:#6b7280">Clear</button>
  </div>
</div>

<!-- ADD TRANSACTION -->
<div class="card">
  <h2>Add Transaction</h2>
  <input type="date" id="date" />
  <select id="account">
    <option>Cash</option><option>Bank</option><option>Capital</option>
    <option>Sales</option><option>Purchase</option><option>Expense</option>
  </select>
  <select id="type">
    <option value="debit">Debit (Out)</option>
    <option value="credit">Credit (In)</option>
  </select>
  <input type="number" id="amount" placeholder="Amount" />
  <textarea id="note" placeholder="Note"></textarea>
  <button onclick="addTransaction()">Save Transaction</button>
</div>

<!-- JOURNAL -->
<div class="card scroll">
  <h2>Journal</h2>
  <table id="journal"></table>
<p style="font-size:12px;color:#555">‚úèÔ∏è Click Edit to modify a transaction | üóë Delete to remove</p>
</div>

<!-- TABS -->
<div class="card tabs">
  <button onclick="showTab('ledger')">Ledger</button>
  <button onclick="showTab('trading')">Trading</button>
  <button onclick="showTab('pl')">P & L</button>
  <button onclick="showTab('bs')">Balance Sheet</button>
</div>

<div id="ledger" class="card scroll" style="display:none"><h2>Ledger</h2><table id="ledgerTable"></table></div>
<div id="trading" class="card scroll" style="display:none"><h2>Trading</h2><div id="tradingData"></div></div>
<div id="pl" class="card scroll" style="display:none"><h2>Profit & Loss</h2><div id="plData"></div></div>
<div id="bs" class="card scroll" style="display:none"><h2>Balance Sheet</h2><div id="bsData"></div></div>

<script>
let data = JSON.parse(localStorage.getItem('accounts')) || [];
let filtered = [...data];
let editIndex = null;
let filtered = [...data];

function toggleFilter(){
  filterBox.style.display = filterBox.style.display==='none'?'block':'none';
}

function addTransaction(){
  if(!date.value || !amount.value) return alert('Date & Amount required');

  const tx = {
    date: date.value,
    account: account.value,
    type: type.value,
    amount: +amount.value,
    note: note.value
  };

  if(editIndex !== null){
    data[editIndex] = tx;
    editIndex = null;
  } else {
    data.push(tx);
  }

  localStorage.setItem('accounts',JSON.stringify(data));
  filtered=[...data];
  date.value=amount.value=note.value='';
  render();
}

function applyFilter(){
  filtered=data.filter(t=>{
    if(fromDate.value && t.date<fromDate.value) return false;
    if(toDate.value && t.date>toDate.value) return false;
    if(month.value!=='' && new Date(t.date).getMonth()!=month.value) return false;
    return true;
  });
  render();
}

function clearFilter(){ filtered=[...data]; render(); }

function render(){ renderJournal(); renderLedger(); renderReports(); }

function renderJournal(){
  journal.innerHTML='<tr><th>Date</th><th>Account</th><th>In</th><th>Out</th><th>Note</th><th>Action</th></tr>';
  filtered.forEach((t,i)=>{
    journal.innerHTML+=`<tr>
      <td>${t.date}</td>
      <td>${t.account}</td>
      <td style="color:green">${t.type==='credit'?t.amount:''}</td>
      <td style="color:red">${t.type==='debit'?t.amount:''}</td>
      <td>${t.note}</td>
      <td>
        <button onclick="editTx(${i})">‚úèÔ∏è</button>
        <button onclick="deleteTx(${i})" style="background:#dc2626">üóë</button>
      </td>
    </tr>`;
  });
}

function renderLedger(){
  const m={};
  filtered.forEach(t=>{m[t.account]=(m[t.account]||0)+(t.type==='debit'?t.amount:-t.amount)});
  ledgerTable.innerHTML='<tr><th>Account</th><th>Balance</th></tr>';
  for(let a in m) ledgerTable.innerHTML+=`<tr><td>${a}</td><td>${m[a]}</td></tr>`;
}

function editTx(i){
  const t = filtered[i];
  const realIndex = data.indexOf(t);
  editIndex = realIndex;
  date.value = t.date;
  account.value = t.account;
  type.value = t.type;
  amount.value = t.amount;
  note.value = t.note;
}

function deleteTx(i){
  if(!confirm('Delete this transaction?')) return;
  const t = filtered[i];
  const realIndex = data.indexOf(t);
  data.splice(realIndex,1);
  localStorage.setItem('accounts',JSON.stringify(data));
  filtered=[...data];
  render();
}

function renderReports(){
  let s=0,p=0,e=0;
  filtered.forEach(t=>{ if(t.account==='Sales')s+=t.amount; if(t.account==='Purchase')p+=t.amount; if(t.account==='Expense')e+=t.amount; });
  tradingData.innerHTML=`Sales ‚Çπ${s}<br>Purchase ‚Çπ${p}`;
  const profit=s-p-e;
  plData.innerHTML=`Expense ‚Çπ${e}<br><b>Profit ‚Çπ${profit}</b>`;
  bsData.innerHTML=`Capital + Profit = ‚Çπ${profit}`;
}

function showTab(id){ ['ledger','trading','pl','bs'].forEach(t=>document.getElementById(t).style.display='none'); document.getElementById(id).style.display='block'; }

render();
</script>
</body>
</html>
