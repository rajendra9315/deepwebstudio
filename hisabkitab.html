<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Secure Money Journal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body { font-family: Arial, sans-serif; background:#f4f6f8; margin:0; padding:16px; }
    h1,h2,h3 { margin:8px 0; }
    .card { background:#fff; padding:12px; border-radius:8px; margin-bottom:16px; box-shadow:0 2px 6px rgba(0,0,0,0.08); }
    input, select, textarea, button { width:100%; padding:8px; margin:6px 0; }
    button { background:#2563eb; color:#fff; border:none; border-radius:6px; cursor:pointer; }
    table { width:100%; border-collapse:collapse; }
    td { padding:6px 4px; border-bottom:1px solid #eee; }
    .date-header { background:#f0f0f0; padding:6px; font-weight:bold; }
    .day-total { font-weight:bold; text-align:right; padding:6px; }
    .in { color:green; }
    .out { color:red; }
    .actions button { width:auto; margin-left:4px; font-size:12px; }
    .note { white-space:nowrap; overflow:hidden; text-overflow:ellipsis; max-width:120px; display:inline-block; }
  </style>
</head>
<body>

<!-- PASSWORD SCREEN -->
<div id="lock" class="card">
  <h2>üîí Enter Password</h2>
  <input type="password" id="pwd" placeholder="Password" />
  <button onclick="unlock()">Unlock</button>
</div>

<!-- APP -->
<div id="app" style="display:none">

<h1>üìò Money Journal</h1>

<!-- ADD TRANSACTION -->
<div class="card">
  <h3>Add Transaction</h3>
  <input type="date" id="date" />
  <select id="type">
    <option value="in">Money In</option>
    <option value="out">Money Out</option>
  </select>
  <input type="number" id="amount" placeholder="Amount" />
  <textarea id="note" placeholder="Note"></textarea>
  <button onclick="saveTx()">Save</button>
</div>

<!-- JOURNAL -->
<div class="card">
  <h3>Journal</h3>
  <div id="journal"></div>
</div>

<!-- TOTAL SUMMARY -->
<div class="card" id="summary"></div>

<!-- CALCULATOR -->
<div class="card">
  <button onclick="toggleCalc()">üßÆ Calculator</button>
  <div id="calcBox" style="display:none">
    <input type="text" id="calc" readonly />
    <div>
      <button onclick="press('7')">7</button><button onclick="press('8')">8</button><button onclick="press('9')">9</button><button onclick="press('/')">√∑</button>
      <button onclick="press('4')">4</button><button onclick="press('5')">5</button><button onclick="press('6')">6</button><button onclick="press('*')">√ó</button>
      <button onclick="press('1')">1</button><button onclick="press('2')">2</button><button onclick="press('3')">3</button><button onclick="press('-')">‚àí</button>
      <button onclick="press('0')">0</button><button onclick="press('.')">.</button><button onclick="calcEq()">=</button><button onclick="press('+')">+</button>
      <button onclick="clearCalc()" style="background:#6b7280">Clear</button>
    </div>
  </div>
</div>

</div>

<script>
/* ===== PASSWORD ===== */
const FIXED_PASSWORD = '1234';
function unlock(){
  if(pwd.value === FIXED_PASSWORD){
    lock.style.display='none';
    app.style.display='block';
  } else alert('Wrong password');
}

/* ===== DATA ===== */
let data = JSON.parse(localStorage.getItem('journal')) || [];
let editIndex = null;

function saveTx(){
  if(!date.value || !amount.value) return alert('Date & amount required');
  const tx = {date:date.value,type:type.value,amount:+amount.value,note:note.value};
  if(editIndex!==null){ data[editIndex]=tx; editIndex=null; }
  else data.push(tx);
  localStorage.setItem('journal',JSON.stringify(data));
  date.value=amount.value=note.value='';
  render();
}

function render(){
  journal.innerHTML='';
  let totalIn=0,totalOut=0;
  const grouped={};
  data.forEach(t=>{ grouped[t.date]=grouped[t.date]||[]; grouped[t.date].push(t); });

  Object.keys(grouped).sort().forEach(d=>{
    let dayIn=0,dayOut=0;
    journal.innerHTML+=`<div class='date-header'>üìÖ ${d}</div>`;
    grouped[d].forEach((t,i)=>{
      if(t.type==='in'){dayIn+=t.amount; totalIn+=t.amount;}
      else{dayOut+=t.amount; totalOut+=t.amount;}
      journal.innerHTML+=`
        <table><tr>
          <td class='${t.type}'>${t.type==='in'?'+‚Çπ'+t.amount:'-‚Çπ'+t.amount}</td>
          <td><span class='note' title='${t.note}'>${t.note}</span></td>
          <td class='actions'>
            <button onclick='editTx(${data.indexOf(t)})'>‚úèÔ∏è Edit</button>
            <button onclick='delTx(${data.indexOf(t)})' style='background:#dc2626'>üóë Delete</button>
          </td>
        </tr></table>`;
    });
    const dayNet = dayIn-dayOut;
    journal.innerHTML+=`<div class='day-total ${dayNet>=0?'in':'out'}'>Day Total: ‚Çπ${dayNet}</div>`;
  });

  summary.innerHTML=`
    <h3>Total Summary</h3>
    <div class='in'>Money In: ‚Çπ${totalIn}</div>
    <div class='out'>Money Out: ‚Çπ${totalOut}</div>
    <b>Net: ‚Çπ${totalIn-totalOut}</b>`;
}

function editTx(i){ const t=data[i]; editIndex=i; date.value=t.date; type.value=t.type; amount.value=t.amount; note.value=t.note; }
function delTx(i){ if(confirm('Delete?')){ data.splice(i,1); localStorage.setItem('journal',JSON.stringify(data)); render(); }}

/* ===== CALCULATOR ===== */
function toggleCalc(){ calcBox.style.display=calcBox.style.display==='none'?'block':'none'; }
function press(v){ calc.value+=v; }
function calcEq(){ try{calc.value=eval(calc.value);}catch{calc.value='Error';} }
function clearCalc(){ calc.value=''; }

render();
</script>
</body>
</html>
